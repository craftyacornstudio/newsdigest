<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>News Digest - Facts vs Opinions</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Lucide icons as inline SVG components
    const Newspaper = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
      </svg>
    );

    const Loader2 = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
      </svg>
    );

    const Coffee = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18 8h1a4 4 0 010 8h-1M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8z" />
      </svg>
    );

    function NewsDigest() {
      const [articleText, setArticleText] = useState('');
      const [result, setResult] = useState(null);
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState('');
      const [useSimpleEnglish, setUseSimpleEnglish] = useState(false);

      const analyzeArticle = async () => {
        if (!articleText.trim()) {
          setError("Oops! I need you to paste a news article first so I can break it down for you.");
          return;
        }

        setLoading(true);
        setError('');
        setResult(null);

        try {
          const response = await fetch('https://api.anthropic.com/v1/messages', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              model: 'claude-sonnet-4-20250514',
              max_tokens: 1000,
              messages: [
                {
                  role: 'user',
                  content: `Analyze this news article and separate facts from opinions. ${useSimpleEnglish ? 'Use simple, easy-to-understand English that anyone can follow. Avoid jargon and complex words.' : ''} Return ONLY a JSON object with this exact structure, no markdown formatting:

{
  "headline": "Brief headline summarizing the main fact",
  "facts": ["fact 1", "fact 2", "fact 3"],
  "opinions": ["opinion 1", "opinion 2"]
}

Article:
${articleText}

Remember: Return ONLY the JSON object, nothing else.`
                }
              ]
            })
          });

          const data = await response.json();
          const content = data.content.find(block => block.type === 'text')?.text || '';
          
          const cleanContent = content.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
          const parsed = JSON.parse(cleanContent);
          
          setResult(parsed);
        } catch (err) {
          setError("Hmm, something went wrong on my end. Mind trying that again?");
          console.error(err);
        } finally {
          setLoading(false);
        }
      };

      const loadExample = () => {
        setArticleText(`Tech giant announces major expansion plans. The company revealed yesterday it will invest $10 billion in new data centers across five states, creating an estimated 5,000 jobs over the next three years.

CEO Sarah Chen called the move "transformative for the industry" and predicted it would revolutionize cloud computing. Industry analysts suggest this aggressive expansion could pressure competitors to follow suit.

The announcement comes amid growing demand for AI infrastructure. Some experts warn the rapid expansion might strain local power grids, though the company insists it will use renewable energy sources.`);
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
          <div className="max-w-4xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <div className="flex items-center gap-3 mb-6">
                <Newspaper className="w-8 h-8 text-indigo-600" />
                <h1 className="text-3xl font-bold text-gray-800">News Digest</h1>
              </div>
              <p className="text-gray-600 mb-6">
                Hey! I'll help you cut through the noise. Just paste a news article and I'll tell you what actually happened versus what people are saying about it.
              </p>

              <div className="mb-6">
                <div className="flex justify-between items-center mb-2">
                  <label className="block text-sm font-medium text-gray-700">
                    Paste Your Article Here
                  </label>
                  <button
                    onClick={loadExample}
                    className="text-sm text-indigo-600 hover:text-indigo-800 font-medium"
                  >
                    Show Me an Example
                  </button>
                </div>
                <textarea
                  value={articleText}
                  onChange={(e) => setArticleText(e.target.value)}
                  placeholder="Go ahead, paste anything you've been reading about..."
                  className="w-full h-48 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"
                />
              </div>

              <div className="mb-6">
                <label className="flex items-center gap-2 cursor-pointer">
                  <input
                    type="checkbox"
                    checked={useSimpleEnglish}
                    onChange={(e) => setUseSimpleEnglish(e.target.checked)}
                    className="w-4 h-4 text-indigo-600 rounded focus:ring-2 focus:ring-indigo-500"
                  />
                  <span className="text-sm text-gray-700">
                    Make it super simple to understand (no fancy words)
                  </span>
                </label>
              </div>

              <button
                onClick={analyzeArticle}
                disabled={loading}
                className="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
              >
                {loading ? (
                  <>
                    <Loader2 className="w-5 h-5 animate-spin" />
                    Hold on, I'm reading this...
                  </>
                ) : (
                  "Let's Break This Down"
                )}
              </button>

              {error && (
                <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700">
                  {error}
                </div>
              )}

              {result && (
                <div className="mt-8 space-y-6">
                  <div className="bg-indigo-50 border-l-4 border-indigo-600 p-4 rounded-r-lg">
                    <h2 className="text-xl font-bold text-indigo-900">
                      {result.headline}
                    </h2>
                  </div>

                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
                      <span className="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">
                        FACTS
                      </span>
                      Here's What Actually Happened
                    </h3>
                    <div className="space-y-2">
                      {result.facts.map((fact, index) => (
                        <div key={index} className="flex gap-3 p-3 bg-gray-50 rounded-lg">
                          <span className="text-green-600 font-bold flex-shrink-0">•</span>
                          <p className="text-gray-700">{fact}</p>
                        </div>
                      ))}
                    </div>
                  </div>

                  {result.opinions && result.opinions.length > 0 && (
                    <div className="pt-4 border-t border-gray-200">
                      <h3 className="text-sm font-semibold text-gray-600 mb-3 flex items-center gap-2">
                        <span className="bg-amber-100 text-amber-800 text-xs font-bold px-2 py-1 rounded">
                          OPINIONS
                        </span>
                        And Here's What People Are Saying About It
                      </h3>
                      <div className="space-y-2">
                        {result.opinions.map((opinion, index) => (
                          <div key={index} className="flex gap-3 p-3 bg-amber-50 rounded-lg">
                            <span className="text-amber-600 font-bold flex-shrink-0">→</span>
                            <p className="text-gray-600 text-sm italic">{opinion}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              )}
            </div>

            <div className="text-center mt-6 space-y-3">
              <p className="text-gray-600 text-sm">
                Your personal BS detector, powered by AI ✨
              </p>
              <a
                href="https://buymeacoffee.com/craftyacorn"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-2 px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-gray-800 font-medium rounded-lg transition-colors shadow-sm"
              >
                <Coffee className="w-4 h-4" />
                Buy me a coffee
              </a>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<NewsDigest />, document.getElementById('root'));
  </script>
</body>
</html>
