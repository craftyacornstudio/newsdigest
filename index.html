<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>News Digest - Facts vs Opinions</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const Newspaper = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
      </svg>
    );

    const Loader2 = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
      </svg>
    );

    const Coffee = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18 8h1a4 4 0 010 8h-1M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8z" />
      </svg>
    );

    function NewsDigest() {
      const [articleText, setArticleText] = useState('');
      const [result, setResult] = useState(null);
      const [loading, setLoading] = useState(false);
      const [useSimpleEnglish, setUseSimpleEnglish] = useState(false);

      const analyzeArticle = () => {
        if (!articleText.trim()) {
          return;
        }

        setLoading(true);
        setResult(null);

        // Simulate processing time for better UX
        setTimeout(() => {
          const sentences = articleText
            .split(/[.!?]+/)
            .map(s => s.trim())
            .filter(s => {
              // Filter out very short sentences
              if (s.length < 10) return false;
              
              // Filter out common non-content patterns
              const lower = s.toLowerCase();
              if (lower.includes('sign up') || 
                  lower.includes('privacy notice') ||
                  lower.includes('newsletter') ||
                  lower.includes('subscribe') ||
                  lower.includes('cookies') ||
                  lower.includes('advertisement') ||
                  lower.includes('share there will be') ||
                  lower.match(/^\d{2}\s*(cet|est|pst|gmt)/i) || // timestamps
                  lower.match(/^share\s/i) || // "Share" prompts
                  lower.includes('contain information about charities')) {
                return false;
              }
              
              return true;
            });

          const facts = [];
          const opinions = [];

          sentences.forEach(sentence => {
            const lowerSentence = sentence.toLowerCase();
            
            // Skip if it's clearly not news content
            if (lowerSentence.includes('privacy notice') ||
                lowerSentence.includes('newsletter') ||
                lowerSentence.includes('share there will be') ||
                sentence.length < 20) {
              return;
            }
            
            // Check for quotes (usually facts when attributed)
            const hasQuote = sentence.includes('"') || sentence.includes("'");
            
            // Check for numbers/data
            const hasNumbers = /\d+/.test(sentence);
            
            // Strong opinion indicators (predictions, judgments, interpretations)
            const strongOpinionWords = [
              'should', 'must', 'ought to',
              'will likely', 'probably will', 'may well',
              'could pressure', 'might force', 'seems to suggest',
              'appears to indicate', 'little to celebrate',
              'raises questions about', 'casts doubt on'
            ];
            
            // Weak opinion indicators (only count if no facts present)
            const weakOpinionWords = [
              'expects', 'predicts', 'believes', 'thinks',
              'analysts say', 'experts warn', 'critics argue'
            ];
            
            // Fact indicators
            const factKeywords = [
              'announced', 'reported', 'confirmed', 'stated', 'revealed',
              'according to', 'said', 'told', 'showed', 'found',
              'data shows', 'statistics', 'pleads', 'charged',
              'trial', 'court', 'accused', 'filed'
            ];

            // Count strong opinions
            const strongOpinionScore = strongOpinionWords.filter(word => 
              lowerSentence.includes(word)
            ).length;
            
            // Count weak opinions
            const weakOpinionScore = weakOpinionWords.filter(word => 
              lowerSentence.includes(word)
            ).length;
            
            // Count fact keywords
            const factScore = factKeywords.filter(keyword => 
              lowerSentence.includes(keyword)
            ).length;

            // Classify the sentence
            // Only mark as opinion if strong opinion words OR (weak opinion AND no facts)
            if (strongOpinionScore > 0) {
              if (opinions.length < 4) {
                opinions.push(sentence);
              }
            } else if (weakOpinionScore > 0 && factScore === 0 && !hasQuote && !hasNumbers) {
              if (opinions.length < 4) {
                opinions.push(sentence);
              }
            } else if (hasQuote || hasNumbers || factScore > 0) {
              // Clearly factual
              if (facts.length < 6) {
                facts.push(sentence);
              }
            } else if (facts.length < 3) {
              // Default to facts if neutral
              facts.push(sentence);
            }
          });

          // Generate headline - look for most informative sentence
          let headline = '';
          
          // Try to find a sentence with key info (names, actions, events)
          const informativeSentence = sentences.find(s => {
            const lower = s.toLowerCase();
            return (lower.includes('charged') || lower.includes('trial') || 
                    lower.includes('accused') || lower.includes('announced') ||
                    lower.includes('said') || lower.includes('revealed')) && 
                   s.length > 40 && s.length < 150;
          });
          
          headline = informativeSentence || facts[0] || sentences[0] || "News Summary";

          // Simplify language if requested
          const simplify = (text) => {
            if (!useSimpleEnglish) return text;
            
            let simplified = text
              // Complex words to simple
              .replace(/announced/gi, 'said')
              .replace(/revealed/gi, 'told us')
              .replace(/approximately/gi, 'about')
              .replace(/subsequently/gi, 'then')
              .replace(/infrastructure/gi, 'buildings')
              .replace(/transformative/gi, 'big change')
              .replace(/revolutionize/gi, 'change everything')
              .replace(/aggressive/gi, 'big')
              .replace(/expansion/gi, 'growing')
              .replace(/amid/gi, 'during')
              .replace(/insists/gi, 'says')
              .replace(/pleads/gi, 'says')
              .replace(/charged with/gi, 'accused of')
              .replace(/standing trial/gi, 'going to court')
              .replace(/crown princess/gi, 'princess')
              .replace(/monarchy/gi, 'royal family')
              .replace(/reigning monarch/gi, 'king or queen')
              .replace(/pulmonary fibrosis/gi, 'lung disease')
              .replace(/transplant/gi, 'new organ surgery')
              .replace(/latest tranche/gi, 'new batch')
              .replace(/outpouring of support/gi, 'lots of support')
              .replace(/public outpouring/gi, 'lots of people supporting')
              
              // Remove complex phrases
              .replace(/in practice,/gi, 'Really,')
              .replace(/as recently as/gi, 'just in')
              .replace(/there will be little to celebrate when/gi, 'it\'s sad that')
              .replace(/raises questions about/gi, 'makes people wonder about')
              .replace(/casts doubt on/gi, 'makes people question')
              
              // Shorten wordy phrases  
              .replace(/planned to leave the country for at least some of the trial/gi, 'planned to leave during the trial')
              .replace(/changed her mind after/gi, 'stayed because')
              .replace(/files, released last Friday by the US justice department, appeared to include/gi, 'files showed');
            
            return simplified;
          };

          // Add context to headlines
          const addContext = (text) => {
            if (!useSimpleEnglish) return text;
            
            // Add context for unclear names/titles
            if (text.includes('Mette-Marit') || text.includes('crown princess')) {
              text = text.replace(/Can Mette-Marit/gi, 'Can Norway\'s Princess Mette-Marit');
              text = text.replace(/The crown princess/gi, 'Princess Mette-Marit (Norway\'s future queen)');
            }
            
            if (text.includes('Marius Borg')) {
              text = text.replace(/Marius Borg Høiby/gi, 'Marius (the princess\'s son)');
            }
            
            if (text.includes('King Harald')) {
              text = text.replace(/King Harald/gi, 'Norway\'s King Harald');
            }
            
            return text;
          };

          // Final cleanup - remove any junk that slipped through
          const cleanResults = (arr) => {
            return arr.filter(item => {
              const lower = item.toLowerCase();
              // Remove anything that's clearly not news content
              return !lower.includes('privacy notice') &&
                     !lower.includes('newsletter') &&
                     !lower.includes('charities, online ads') &&
                     !lower.match(/^\d{2}\s*(cet|est)/i) &&
                     !lower.startsWith('share ') &&
                     item.length > 15;
            });
          };

          setResult({
            headline: addContext(simplify(headline.length > 80 ? headline.substring(0, 80) + '...' : headline)),
            facts: cleanResults(facts.slice(0, 5)).map(f => addContext(simplify(f))),
            opinions: cleanResults(opinions.slice(0, 3)).map(o => addContext(simplify(o)))
          });

          setLoading(false);
        }, 800);
      };

      const loadExample = () => {
        setArticleText(`Tech giant announces major expansion plans. The company revealed yesterday it will invest $10 billion in new data centers across five states, creating an estimated 5,000 jobs over the next three years.

CEO Sarah Chen called the move "transformative for the industry" and predicted it would revolutionize cloud computing. Industry analysts suggest this aggressive expansion could pressure competitors to follow suit.

The announcement comes amid growing demand for AI infrastructure. Some experts warn the rapid expansion might strain local power grids, though the company insists it will use renewable energy sources.`);
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
          <div className="max-w-4xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <div className="flex items-center gap-3 mb-6">
                <Newspaper className="w-8 h-8 text-indigo-600" />
                <h1 className="text-3xl font-bold text-gray-800">News Digest</h1>
              </div>
              <p className="text-gray-600 mb-6">
                Hey! I'll help you cut through the noise. Just paste a news article and I'll tell you what actually happened versus what people are saying about it.
              </p>
              <div className="bg-green-50 border-l-4 border-green-400 p-3 mb-4 text-sm text-green-800">
                <strong>100% Free & Private:</strong> Everything runs in your browser. No data sent anywhere!
              </div>

              <div className="mb-6">
                <div className="flex justify-between items-center mb-2">
                  <label className="block text-sm font-medium text-gray-700">
                    Paste Your Article Here
                  </label>
                  <button
                    onClick={loadExample}
                    className="text-sm text-indigo-600 hover:text-indigo-800 font-medium"
                  >
                    Show Me an Example
                  </button>
                </div>
                <textarea
                  value={articleText}
                  onChange={(e) => setArticleText(e.target.value)}
                  placeholder="Go ahead, paste anything you've been reading about..."
                  className="w-full h-48 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"
                />
              </div>

              <div className="mb-6">
                <label className="flex items-center gap-2 cursor-pointer">
                  <input
                    type="checkbox"
                    checked={useSimpleEnglish}
                    onChange={(e) => setUseSimpleEnglish(e.target.checked)}
                    className="w-4 h-4 text-indigo-600 rounded focus:ring-2 focus:ring-indigo-500"
                  />
                  <span className="text-sm text-gray-700">
                    Make it super simple (easy words + explain who people are)
                  </span>
                </label>
              </div>

              <button
                onClick={analyzeArticle}
                disabled={loading || !articleText.trim()}
                className="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
              >
                {loading ? (
                  <>
                    <Loader2 className="w-5 h-5 animate-spin" />
                    Hold on, I'm reading this...
                  </>
                ) : (
                  "Let's Break This Down"
                )}
              </button>

              {result && (
                <div className="mt-8 space-y-6">
                  <div className="bg-indigo-50 border-l-4 border-indigo-600 p-4 rounded-r-lg">
                    <h2 className="text-xl font-bold text-indigo-900">
                      {result.headline}
                    </h2>
                  </div>

                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
                      <span className="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">
                        FACTS
                      </span>
                      Here's What Actually Happened
                    </h3>
                    <div className="space-y-2">
                      {result.facts.map((fact, index) => (
                        <div key={index} className="flex gap-3 p-3 bg-gray-50 rounded-lg">
                          <span className="text-green-600 font-bold flex-shrink-0">•</span>
                          <p className="text-gray-700">{fact}</p>
                        </div>
                      ))}
                    </div>
                  </div>

                  {result.opinions && result.opinions.length > 0 && (
                    <div className="pt-4 border-t border-gray-200">
                      <h3 className="text-sm font-semibold text-gray-600 mb-3 flex items-center gap-2">
                        <span className="bg-amber-100 text-amber-800 text-xs font-bold px-2 py-1 rounded">
                          OPINIONS
                        </span>
                        And Here's What People Are Saying About It
                      </h3>
                      <div className="space-y-2">
                        {result.opinions.map((opinion, index) => (
                          <div key={index} className="flex gap-3 p-3 bg-amber-50 rounded-lg">
                            <span className="text-amber-600 font-bold flex-shrink-0">→</span>
                            <p className="text-gray-600 text-sm italic">{opinion}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {(!result.opinions || result.opinions.length === 0) && (
                    <div className="pt-4 border-t border-gray-200">
                      <p className="text-gray-500 text-sm italic">
                        No clear opinions or commentary found in this article - it's mostly factual reporting!
                      </p>
                    </div>
                  )}
                </div>
              )}
            </div>

            <div className="text-center mt-6 space-y-3">
              <p className="text-gray-600 text-sm">
                Your personal BS detector ✨
              </p>
              <a
                href="https://buymeacoffee.com/craftyacorn"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-2 px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-gray-800 font-medium rounded-lg transition-colors shadow-sm"
              >
                <Coffee className="w-4 h-4" />
                Buy me a coffee
              </a>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<NewsDigest />, document.getElementById('root'));
  </script>
</body>
</html>
